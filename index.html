<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>简易多轨道时间线编辑器（类似AE）</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, sans-serif;
        }
        body {
            background-color: #1a1a1a;
            color: #f0f0f0;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* 顶部控制栏 */
        .top-controls {
            background-color: #2d2d2d;
            padding: 12px 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            border-bottom: 1px solid #444;
        }
        .project-title {
            font-size: 18px;
            font-weight: 500;
            color: #fff;
        }
        .control-btn {
            background-color: #3d3d3d;
            border: none;
            color: #fff;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: background 0.2s;
        }
        .control-btn:hover {
            background-color: #4a4a4a;
        }
        .play-btn {
            background-color: #0078d7;
        }
        .play-btn:hover {
            background-color: #005a9e;
        }
        .timecode {
            margin-left: auto;
            font-family: monospace;
            color: #a0a0a0;
        }

        /* 轨道区域 */
        .timeline-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* 轨道名称列 */
        .track-names {
            width: 200px;
            background-color: #252525;
            border-right: 1px solid #444;
            overflow-y: auto;
        }
        .track-name-item {
            padding: 12px 15px;
            border-bottom: 1px solid #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .track-icon {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        .audio-icon {
            background-color: #008000;
        }
        .video-icon {
            background-color: #ff0000;
        }

        /* 时间线轨道列 */
        .tracks-timeline {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* 时间标尺 */
        .time-ruler {
            height: 30px;
            background-color: #252525;
            border-bottom: 1px solid #444;
            position: relative;
            padding-left: 50px;
            overflow: hidden;
        }
        .ruler-marks {
            display: flex;
            height: 100%;
            align-items: flex-end;
        }
        .ruler-mark {
            width: 50px;
            border-left: 1px solid #555;
            height: 10px;
            position: relative;
        }
        .ruler-mark::after {
            content: attr(data-time);
            position: absolute;
            bottom: -20px;
            left: -15px;
            font-size: 12px;
            color: #aaa;
            font-family: monospace;
        }

        /* 轨道内容区域 */
        .tracks-content {
            flex: 1;
            overflow: auto;
            position: relative;
            background-color: #1a1a1a;
            background-image: 
                linear-gradient(to right, #2d2d2d 1px, transparent 1px),
                linear-gradient(to bottom, #2d2d2d 1px, transparent 1px);
            background-size: 50px 60px; /* 网格大小：时间刻度×轨道高度 */
            padding-left: 50px;
        }

        /* 播放头（时间指示器） */
        .playhead {
            position: absolute;
            top: 0;
            left: 50px; /* 与时间标尺对齐 */
            width: 2px;
            height: 100%;
            background-color: #ff0000;
            z-index: 10;
            pointer-events: none;
        }
        .playhead::after {
            content: '';
            position: absolute;
            top: -5px;
            left: -4px;
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid #ff0000;
        }

        /* 轨道内容块（类似AE的素材片段） */
        .track-item {
            position: absolute;
            height: 50px;
            background-color: rgba(0, 120, 215, 0.7);
            border-radius: 3px;
            top: 5px; /* 轨道内边距 */
            display: flex;
            align-items: center;
            padding: 0 10px;
            cursor: move;
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            font-size: 14px;
        }
        .track-1 { top: 5px; }    /* 轨道1位置 */
        .track-2 { top: 65px; }   /* 轨道2位置（轨道高度60px） */
        .track-3 { top: 125px; }  /* 轨道3位置 */

        /* 底部缩放控制 */
        .zoom-controls {
            height: 30px;
            background-color: #252525;
            border-top: 1px solid #444;
            display: flex;
            align-items: center;
            padding: 0 20px;
            gap: 10px;
        }
        .zoom-btn {
            background: none;
            border: none;
            color: #aaa;
            cursor: pointer;
            font-size: 16px;
        }
        .zoom-btn:hover {
            color: #fff;
        }
        .zoom-slider {
            flex: 1;
            height: 4px;
            background-color: #444;
            border-radius: 2px;
            position: relative;
        }
        .zoom-thumb {
            position: absolute;
            width: 12px;
            height: 12px;
            background-color: #0078d7;
            border-radius: 50%;
            top: 50%;
            transform: translateY(-50%);
            left: 30%; /* 初始缩放比例 */
        }
    </style>
</head>
<body>
    <!-- 顶部控制栏 -->
    <div class="top-controls">
        <div class="project-title">我的项目 - 多轨道编辑</div>
        <button class="control-btn play-btn" id="playPauseBtn">
            <span>▶</span> 播放/暂停
        </button>
        <button class="control-btn">
            <span>↺</span> 重置
        </button>
        <div class="timecode" id="timecode">00:00:00.00</div>
    </div>

    <!-- 时间线主体 -->
    <div class="timeline-container">
        <!-- 轨道名称列 -->
        <div class="track-names">
            <div class="track-name-item">
                <div class="track-icon audio-icon">A</div>
                <div>音频轨道 1</div>
            </div>
            <div class="track-name-item">
                <div class="track-icon audio-icon">A</div>
                <div>音频轨道 2</div>
            </div>
            <div class="track-name-item">
                <div class="track-icon video-icon">V</div>
                <div>视频轨道 1</div>
            </div>
        </div>

        <!-- 时间线轨道列 -->
        <div class="tracks-timeline">
            <!-- 时间标尺 -->
            <div class="time-ruler">
                <div class="ruler-marks" id="rulerMarks">
                    <!-- 动态生成刻度 -->
                </div>
            </div>

            <!-- 轨道内容区域 -->
            <div class="tracks-content" id="tracksContent">
                <!-- 播放头 -->
                <div class="playhead" id="playhead"></div>

                <!-- 轨道1内容 -->
                <div class="track-item track-1" style="width: 200px; left: 50px;">
                    背景音乐.mp3
                </div>

                <!-- 轨道2内容 -->
                <div class="track-item track-2" style="width: 150px; left: 150px;">
                    人声.wav
                </div>

                <!-- 轨道3内容 -->
                <div class="track-item track-3" style="width: 300px; left: 50px;">
                    主画面.mp4
                </div>
            </div>
        </div>
    </div>

    <!-- 底部缩放控制 -->
    <div class="zoom-controls">
        <button class="zoom-btn" id="zoomOut">-</button>
        <div class="zoom-slider">
            <div class="zoom-thumb" id="zoomThumb"></div>
        </div>
        <button class="zoom-btn" id="zoomIn">+</button>
    </div>

    <script>
        // 核心变量
        const playhead = document.getElementById('playhead');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const timecodeEl = document.getElementById('timecode');
        const rulerMarks = document.getElementById('rulerMarks');
        const tracksContent = document.getElementById('tracksContent');
        const zoomThumb = document.getElementById('zoomThumb');
        
        let isPlaying = false;
        let currentTime = 0; // 当前时间（秒）
        let duration = 30; // 总时长（秒）
        let frameRate = 30; // 帧率（用于时间显示）
        let zoomLevel = 30; // 缩放比例（百分比）
        let animationFrameId = null;

        // 初始化时间标尺
        function initRuler() {
            rulerMarks.innerHTML = '';
            // 生成时间刻度（每1秒一个刻度）
            for (let i = 0; i <= duration; i++) {
                const mark = document.createElement('div');
                mark.className = 'ruler-mark';
                mark.dataset.time = formatTime(i);
                rulerMarks.appendChild(mark);
            }
        }

        // 格式化时间（00:00:00.00）
        function formatTime(seconds) {
            const hours = Math.floor(seconds / 3600).toString().padStart(2, '0');
            const mins = Math.floor((seconds % 3600) / 60).toString().padStart(2, '0');
            const secs = Math.floor(seconds % 60).toString().padStart(2, '0');
            const frames = Math.floor((seconds % 1) * frameRate).toString().padStart(2, '0');
            return `${hours}:${mins}:${secs}.${frames}`;
        }

        // 更新播放头位置
        function updatePlayhead() {
            // 计算位置：50px是左侧偏移，每1秒对应50px宽度（可随缩放调整）
            const position = 50 + (currentTime / duration) * (duration * 50 * (zoomLevel / 50));
            playhead.style.left = `${position}px`;
            timecodeEl.textContent = formatTime(currentTime);
        }

        // 播放/暂停动画
        function togglePlay() {
            isPlaying = !isPlaying;
            playPauseBtn.innerHTML = isPlaying ? '<span>⏸</span> 播放/暂停' : '<span>▶</span> 播放/暂停';
            
            if (isPlaying) {
                animatePlayhead();
            } else if (animationFrameId) {
                cancelAnimationFrame(animationFrameId);
            }
        }

        // 播放头动画
        function animatePlayhead() {
            if (!isPlaying) return;
            
            // 更新当前时间（每帧增加1/60秒，模拟60fps）
            currentTime += 1/60;
            if (currentTime >= duration) {
                currentTime = 0; // 循环播放
            }
            
            updatePlayhead();
            animationFrameId = requestAnimationFrame(animatePlayhead);
        }

        // 缩放时间线
        function updateZoom(level) {
            zoomLevel = Math.max(10, Math.min(100, level)); // 限制缩放范围10-100%
            zoomThumb.style.left = `${zoomLevel}%`;
            
            // 调整网格和轨道内容大小
            const gridWidth = 50 * (zoomLevel / 50); // 缩放后每个刻度的宽度
            tracksContent.style.backgroundSize = `${gridWidth}px 60px`;
            
            // 重新计算播放头位置
            updatePlayhead();
        }

        // 点击时间线跳转
        tracksContent.addEventListener('click', (e) => {
            const rect = tracksContent.getBoundingClientRect();
            const clickX = e.clientX - rect.left; // 相对于轨道内容的X坐标
            const gridWidth = 50 * (zoomLevel / 50);
            
            // 计算点击位置对应的时间
            const clickTime = (clickX - 50) / gridWidth; // 减去左侧50px偏移
            currentTime = Math.max(0, Math.min(duration, clickTime));
            updatePlayhead();
        });

        // 事件监听
        playPauseBtn.addEventListener('click', togglePlay);
        document.querySelector('.control-btn:nth-child(3)').addEventListener('click', () => {
            // 重置时间
            currentTime = 0;
            updatePlayhead();
        });
        document.getElementById('zoomIn').addEventListener('click', () => {
            updateZoom(zoomLevel + 10);
        });
        document.getElementById('zoomOut').addEventListener('click', () => {
            updateZoom(zoomLevel - 10);
        });

        // 初始化
        initRuler();
        updatePlayhead();
    </script>
</body>
</html>